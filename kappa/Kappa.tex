% Sample file on how to use subfiles.
\documentclass[MikaelDissertation.tex]{subfiles}

\begin{document}

\chapter{Introduction}

\section{The process of sintering of hardmetal}

Manufacturing of PM products is based on the ``welding'' (sintering) of particles due to heating or combined heating and mechanical loading (uniaxial or isotropic pressing).
To model and simulate the sintering of hard metals, often including some form of binder metal, is particularly challenging in view of the fact that the sintering process involves both solid and melt states of the constituents.
In brief, the manufacturing process can be split into three different sequential stages:
(I) Compaction of powder compound, with initially around \SI{70}{\percent} porosity, into a ``green body'' with roughly \SIrange{20}{40}{\percent} porosity.
(II) Heating in oven up well above the melting temperature for the binder.
(III) Cooling to room temperature.
As an example, Co is the binder metal (with melting temperature around \SI{1500}{\celsius}) in the system WC-Co-Ti.

The purpose is to achieve net-shape already of the green body, whereby the subsequent sintering would result mainly in change of volume (without distortion, i.e. shear deformation).
Since uniaxial pressing is normally used for the initial compaction of hard metal, it is likely that wall friction leads to inhomogeneous
distribution of residual stresses and bulk density in the green body (at least to some extent).
This is an unwanted effect that obscures the goal of net-shape.

During the heating phase, thermal expansion is combined with a certain amount of solid state sintering before melting of the binder, which is necessary in order to achieve ``liquid-phase'' sintering.
During the hold-time at the given temperature, significant compaction (densification, consolidation) takes place due to a combination of solid deformation, diffusion and liquid motion, which brings about reduced porosity.
The so-called ``sintering stress'', which is a macro-scale manifestation of the surface tension between the constituents and the pores, is the ``driving force'' for compaction; hence, sintering can take place under zero external load of the specimen (known as ``free sintering'').
However, the residual stresses after compaction will effect the process.

% \textbf{Remark:} It is possible to achieve a sintered product below or above the melting temperature of the Co-binder.
% Up to \SI{80}{\percent} of the densification can be achieved in pure solid state sintering, although a completely dense product can only be achieved with liquid phase.
% These two cases are often denoted solid and liquid state sintering, respectively, in the literature.

% There are generally two characteristic stages in terms of porosity characteristics:
% At the early stage of sintering all pores are connected, which leads to quite rapid densification, in particular due to viscous flow of the liquid binder. Later on, within a certain temperature interval, all binder has solidified and the (possibly remaining) pores are closed off (and isolated) into near-equilibrium, which leads to much lower rate of consolidation.

Clearly, the aim of the process is that the final product is completely dense, i.e. there is no rest-porosity, with no net-shape distortion.
This may be hard to accomplish if the green body bulk density is severely inhomogeneous and/or the liquid phase sintering is inefficient (in terms of insufficient amount of binder phase and/or incomplete melting).

\section{Modeling and simulation efforts --- A brief review}

A wealth of literature deals with the modeling and simulation of the sintering process.
Primarily, this relates to the constitutive modeling of
(1) the powder material response for green body (pre)compaction and 
(2) the high temperature response and sintering mechanisms pertinent to both solid and liquid phase sintering.
Modeling efforts can be classified by two major paradigms: \emph{a priori macroscale modeling} and \emph{micromechanics modeling and computational homogenization}.

\subsection{Macroscale modeling}

A vast majority of the existing literature on \emph{a priori} macro-scale modeling is devoted to the compaction stage, and it is noted that very few (if any) attempts have been made to develop a unifying macroscopic constitutive model for the compaction and sintering stages.
As to the compaction process, material rate-independence (elasto-plasticity) is a common (and valid) assumption.
Such plasticity models are often taken, at least conceptually, from soil mechanics.
The major focus is on the evolution of the yield surface due to changing porosity as the predominant hardening mechanism, e.g.\ Fleck et al.\ \cite{fleck_yielding_1992},
Oliver et al.\ \cite{oliver_plasticity_1996}, Brandt and Nilsson \cite{brandt_fe-simulation_1998}, Redanz \cite{redanz_numerical_1998}, Kraft \cite{kraft_optimizing_2003}.

For the solid phase sintering, the major feature is the strong rate-dependence close to, and above, the melting temperature of the binder.
Models based on viscoelasticity and viscoplasticity have, therefore, been proposed to simulate the creep behavior of the highly deformable (and even partly melt) binder, e.g. Shinagawa \cite{shinagawa_finite_1996}, Brandt and Nilsson \cite{brandt_fe-simulation_1998}.
Clearly, it is of utmost importance to model the high sensitivity of yield stress to temperature, e.g. Mähler et al.\ \cite{mahler_modelling_2000}.
The task of providing a rational thermodynamic definition of the sintering stress was addressed by, e.g. Reid and Oakberg \cite{reid_continuum_1990}, Mähler and Runesson \cite{mahler_constitutive_2003}.

As to liquid phase sintering, the text-book by German \cite{german_sintering_1996} is still an authority in the field.
Examples of the rich literature are Svoboda et al.\ \cite{svoboda_model_1996}, Xu and Mehrabahdi \cite{xu_micromechanical_1997}, Lu et al.\ \cite{lu_porosity_2001}, who used a single-phase approach.
In the work by Olevsky and German \cite{olevsky_theory_1998}, \cite{olevsky_effect_2000} we find the modeling of sintering by a linear viscous material model.

Common to these macroscopic models, which are often of quite complex nature with a large number of model parameters, is the need for calibration from experimental data.
Access to such data for various loading scenarios and environmental conditions thus sets the limit of the predictive capabilities.

% To date, it seems that no attempts have been made in the literature to use mixture theory, which explicitly acknowledges the coexistence of a solid skeleton of the WC-particles and partly solidified and liquid Co.

\subsection{Micromechanics modeling and computational homogenization}

Most micromechanically based models consider idealized geometrical arrangement, such as a regular array of spheres, within a Representative Volume Element (RVE).
One common approach is to consider grain boundary diffusion, e.g. Helle, et al.\ \cite{helle_hot-isostatic_1985}, McMeeking and Kuhn \cite{mcmeeking_diffusional_1992}, Riedel and Svoboda \cite{riedel_theoretical_1993} and Shinagawa \cite{shinagawa_finite_1996} and particle bridging via diffusion, e.g. Svoboda and Riedel \cite{svoboda_new_1995}, Bient \cite{bient_modeling_2004}, Luque et al.\ \cite{luque_simulation_2005}, as the principal mechanisms for densification.
In the recent work by Pino-Muñoz et al.\ \cite{pino_munoz_direct_2013} the modeling of multiple spherical particles is based on a level-set description and accounts for volume and surface diffusion.
% TODO: Really?
% Some attempts have been made too include more realistic microstructural arrangements and carry out computational homogenization to obtain response functions, e.g. Mähler and Runesson \cite{mahler_modelling_2000}.

Early attempts to numerically simulate the surface-tension driven reshaping of contacting particles are by Jagota and Dawson \cite{jagota_micromechanical_1988,jagota_micromechanical_1988-1} and van de Vorst \cite{van_de_vorst_integral_1993}.
In a series of papers, Zhou and Derby \cite{zhou_three-dimensional_1998,zhou_assessment_2001} emphasize efficient finite element algorithms to trace the complex 3-dimensional flow of multi-particle interaction.
The main challenges  are the complex subscale geometry and the moving free boundary giving rise to very large deformations and severe topology changes.
Recent developments of free-boundary tracing FE-strategies for large deformations (without severe topological changes) are discussed by Peri\'c and coworkers, \cite{dettmer_computational_2006}, \cite{saksono_finite_2006}, \cite{saksono_finite_2006-1}.
All the mentioned work consider surface tension effects in fluids.
A recent extension to include surface tension in the context of solid modeling, where anisotropic surface energy may be present, is due to Javili and Steinmann \cite{javili_finite_2010}.

Micro-mechanical analysis must be accompanied by computational homogenization in order to obtain a predictive model for a component.
In selected references for homogenization we find Nemat-Nasser and Hori \cite{nemat-nasser_micromechanics:_1993}, Geers et al.\ \cite{geers_multi-scale_2010}, and Larson et al. \cite{larsson_variationally_2010}.
One possibility is socalled upscaling, i. e. to use the subscale modeling to calibrate a macroscopic model.
A more appealing, but theoretically and computationally more challenging, possibility is to carry out full-fledged simultaneous coupling between the micro- and macro-scales, which is known as Computational Multiscale Modeling, or the FE\textsuperscript{2} strategy, cf.\ Feyel et al.\ \cite{feyel_fe2_2000}.
This is certainly the current international trend in material modeling for engineering purposes; however, to our knowledge no work on the fully coupled FE\textsuperscript{2} applied to the sintering problem has been published.

\chapter{Aim and Scope of Research}

The thesis concerns the development of a predictive tool for the computational modeling of sintering of hardmetal, that involves a liquid (melt binder) phase.
Virtually all modeling in the literature aiming for quantitative predictions on the engineering scale is based on \emph{a priori} homogenized macroscopic material models.
In this dissertation, the purpose is rather to obtain the relevant equations via micromechanical modeling and computational homogenization.

In order to achieve the goal, the following tasks are identified:
\begin{itemize}
 \item Develop the micro-mechanical relations for an ideal setting of viscous particles in contact that sinter due to surface tension.
 \item Use computational homogenization and a fully coupled FE\textsuperscript{2} strategy to obtain a predictive model.
 \item Develop FE-software, in particular for efficient implementation of parallel algorithms.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{The fine-scale model problem}

\section{Mixed velocity-pressure formulation}

\begin{figure}[htpb!]
\centering
\begin{tikzpicture}
 \node at (0,0) {\includegraphics[scale=1.0]{figures/GreenBody.pdf}};
 \draw[latex-] (-2.8,0.1) -- ++(-1,0) node[left] {$\Omega^\particle$};
 \draw[latex-] (-2.8,-0.35) to (-3.8,0.1);
 \draw[-] (3.1,0) -- ++(1,0) node[right] {$\Gamma$};
 \draw[<-] (1.42,0.6) -- (4.1,0.6) node[right] {$\Gamma^\pore$};
\end{tikzpicture}
\caption{Green body with its macroscopic shape as dashed line. Particles are not to scale.}
\label{fig:greenbody}
\end{figure}

We consider a generic micro-heterogeneous material in a given ``green body'', whose macroscopic configuration occupies the region $\Omega$ in space with (presumed smooth) boundary $\Gamma$ as seen in \figref{fig:greenbody}.
However, the actual medium has pores, which means that the particle composite occupies only the region $\Omega^\particle$.
This configuration is illustrated in \figref{fig:homogenization}.
In this setting, the instantaneous velocity field $\ta v$ is solved for at any given time, and explicit time-integration is used to drive the deformations.
% We are then lead to defining a Representative Volume Element (RVE), that represents the topology of the micro-heterogeneous microstructure, as shown in \Cref{Figure1}.
% The total domain occupied by the cubic RVE is denoted $\Omega_\rve$ with external boundary $\Gamma_\rve$, while particles within the RVE occupies $\Omega_\rve^\particle$.
%-----------------------------------------------------------------------------------------------------------------------------
% \begin{figure}
% \centering
% %\hspace{0.9cm}
% %\scalebox{1.0}{
% \begin{tikzpicture}
% %\tikzstyle{every node}=[font=\Large]
% \node [inner sep=0pt,above right]{
%    \includegraphics[scale=.3]{SwissCheeseFig}
%    };
% %\draw[<-, line width=.4mm] (1.6,5.0) .. controls +(up:0.5cm) and +(left:0.5cm) .. (2.5,5.7) node[right=1pt,black,text width=3cm,text badly ragged]{$\Gamma_\rve$};
% \draw[<-, line width=.4mm] (5.0,3.5) .. controls +(right:0.5cm) and +(left:0.5cm) .. (6.0,3.5) node[right,black]{$\Gamma_\rve$};
% \draw[<-, line width=.4mm] (4.6,2.) .. controls +(right:0.5cm) and +(left:0.5cm) .. (6.0,2.0) node[right,black]{$\Gamma_\rve^\pore$};
% %\draw[-*, line width=.4mm] (-1.0,1.5) node[left=-2.0cm,black,text width=3cm,text badly ragged]{$\Omega_{\rve,i}^\mathrm{p}$} .. controls +(right:0.5cm) and +(left:1.cm) .. (0.6,1.1);
% \draw[-*, line width=.4mm] (-1.0,2.1) node[left,black]{$\Omega_\rve^\particle$} .. controls +(right:0.5cm) and +(left:1.cm) .. (0.6,2.1);
% \draw[-*, line width=.4mm] (-1.0,3.1) node[left,black]{$\Omega_\rve^\pore$} .. controls +(right:0.5cm) and +(left:1.cm) .. (1.2,3.1);
% %\draw[<-, line width=.4mm] (4.6,1.7) .. controls +(right:0.5cm) and +(left:0.5cm) .. (6.0,1.0) node[right=1pt,black,text width=3cm,text badly ragged]{$\partial\Omega_{\rve,i}^\text{p}$};
% \end{tikzpicture}
% %}
% \caption{Generic micro-heterogeneous material consisting of inclusions in matrix (example)}
% \label{Figure1}
% \end{figure}

We consider a model material as follows: The stress is decomposed in terms of deviator and pressure as $\ts{\sigma} = \ts{\sigma}_\dev - p\ts{I}$.
With the kinematic definition $\devop[\ta v]\defeq[\ta v\outerp\diff]^\sym-\frac{1}{3}[\ta v\cdot\diff]\ts{I}$, we introduce the constitutive relations
%------------------------------------------------------------------------------------------------------------
\begin{equation}
    \ts{\sigma}_\dev = \hat{\ts{\sigma}}_\dev(\devop[\ta v]), \quad
    \ta v\cdot\diff = \hat{e}(p)
\label{eq201}
\end{equation}
%------------------------------------------------------------------------------------------------------
Hence, $\hat{\ts{\sigma}}_\dev(\bullet)$ and $\hat{e}(\bullet)$ denote suitable constitutive functions.
In the simplest case of a viscous fluid, we have $\hat{\ts{\sigma}}_\dev(\ts{d}_\dev)=2\mu\ts{d}_\dev$ and $\hat{e}(p)=- C p$, where the material parameters $\mu(\ta{x}), C(\ta{x})$ for $\ta{x}\in\Omega^\particle$ may fluctuate strongly.
Moreover, intrinsic incompressibility is defined as $\hat{e}(p)=0$ for any value of $p$.
In the case of flow problems, $C = 0$ is the only reasonable choice, however, the more general form is kept to illustrate the similarity between the fine-scale and macro-scale problem.

\begin{figure}[th!]
    \centering
    \input{figures/surface_stress_plane.tikz}
    \caption{Thin shell representing a surface with in-plane forces due to ``surface tension''.}
    \label{fig:surfacestress}
\end{figure}
A vital part of the simulation is the modeling of surface tension, which acts as the ``driving force'' for liquid-phase sintering.
An extensive theory on boundary energy potentials has been developed by Steinmann \cite{steinmann_boundary_2008}, which has served as the basis for the surface tension modeling in this work.
In short; equilibrium across a surface $\mathcal{S}$ represented by a thin shell bounded by the curve $\mathcal{C}$, as in \figref{fig:surfacestress}, can be stated as:
\begin{align}
    \ta{t}^+ + \ta{t}^- + \ta{t}_\surf &= \ta{0} \quad \text{on} \,\, \mathcal{S} \quad \text{with } \ta{t}_\surf \defeq \hat{\ts\sigma}\cdot\hat{\diff}
\label{eq103KR}\\
    \sum_i \hat{\ta t}_i &= \ta{0} \quad \text{on} \,\, \mathcal{C}
\label{eq104KR}
\end{align}
where $\hat\diff \defeq \diff - [\diff\cdot\ta n]\ta n$ is the surface gradient.
For an isotropic surface potential one obtains $\hat{\ts\sigma} = \gamma_\surf[\ts I-\ta n\outerp\ts n]$, and the common expression for the surface traction representing surface tension is obtained:
\begin{align}
 \ta t_\surf = -\kappa \gamma_\surf \ta n
\end{align}
where $\kappa \defeq \ta n \cdot\hat{\diff}$ is the Gaussian curvature.

We are now in the position to formulate the strong format of the fine-scale problem under standard quasistatic conditions:
%------------------------------------------------------------------------------------------------------------
\begin{subequations}\label{eq1}
\begin{alignat}{2}
    -\left[\hat{\ts{\sigma}}_\dev(\devop[\ta v])-p\ts{I}\right]\cdot\diff & = \ta{f} &&\,\,\text{in}\,\, \Omega^\particle
 \label{eq1a} \\
    -\ta v\cdot\diff +  \hat{e}(p) & = 0 &&\,\,\text{in}\,\, \Omega^\particle
\label{eq1b} \\
    \ta v & = \ta v_\prescribed &&\,\,\text{on}\,\, \Gamma^\Dirichlet
\label{eq1c} \\
    \ta{t}\defeq\left[\hat{\ts{\sigma}}_\dev(\devop[\ta v])-p\ts{I}\right]\cdot\ta{n} & = \ta t_\prescribed &&\,\,\text{on}\,\, \Gamma^\Neumann
\label{eq1d} \\
    \ta{t}\defeq\left[\hat{\ts{\sigma}}_\dev(\devop[\ta v])-p\ts{I}\right]\cdot\ta{n} & =\ta{t}_\surf &&\,\,\text{on}\,\, \Gamma^\pore
\label{eq1surf}
\end{alignat}
\end{subequations}
%-----------------------------------------------------------------------------------------------------
The corresponding weak format is: Find $\ta v\in\set{V}, p\in\set{P}$ s.t.
%----------------------------------------------------------------------------------------------------------------
\begin{subequations}\label{eq2}
\begin{alignat}{3}
    a(\ta v;\delta\ta v) + b(p,\delta\ta v) &= l^\pore(\delta\ta v) + l(\delta\ta v) &\quad& \forall \delta\ta v &&\in \set{V}^{0}
\label{eq2a} \\
    b(\delta p,\ta v) + c^*(p;\delta p) &= 0 &\quad& \forall \delta p &&\in \set{P}
\label{eq2b}
\end{alignat}
\end{subequations}
%----------------------------------------------------------------------------------------------------------------------
where $\set{V}$ and $\set{V}^0$ denotes the trial and test spaces for the velocity, respectively, $\set{P}$ is the trial and test space for the pressure field, and the introduced forms are defined as 
%----------------------------------------------------------------------------------------------------------------
\begin{align}
    a(\ta{v};\ta{w}) &\defeq
    \int_{\Omega^\particle}  \devop[\ta{w}]\dprod \hat{\ts{\sigma}}_\dev(\devop[\ta{v}]) \dif V
\label{eq3a} \\
    b(q,\ta{v}) &\defeq
    - \int_{\Omega^\particle}  q\,\ta{v}\cdot\diff \dif V
\label{eq3b} \\
    c^*(q;r) &\defeq
    \int_{\Omega^\particle}  r\,\hat{e}(q) \dif V
\label{eq3c} \\
    l^\pore(\ta{v}) &\defeq -\int_{\Gamma^\pore} \gamma_\surf \hat{\ta I} \dprod [\ta{v}\outerp\diff] \dif S 
\label{eq3d} \\
    l(\ta{v}) &\defeq \int_{\Omega^\particle} \ta{v}\cdot\ta{f} \dif V + \int_{\Gamma^\Neumann} \ta{v}\cdot \ta t_\prescribed \dif S
\label{eq3e}
\end{align}
Here, the term pertaining to surface tension, $l^\pore(\bullet)$, was obtained from \cref{eq103KR} and \cref{eq104KR} using the surface divergence theorem, cf.\ \refpaper{A}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerical aspects}
The mixed $(\ta v,p)$-formulation requires some form of stabilized approximation for use with FEM.
In this thesis, Taylor-Hood elements (quadratic velocity, linear velocity) and Mini-elements (linear pressure, linear approximation enriched by a bubble function for the velocity) have been implemented.
Surface tension has been implemented according to \cref{eq3d}.

During the FE-simulation, the mesh eventually becomes very distorted, in particular at sharp corners subjected to surface tension.
In order to approach full density, pores need to shrink to the point of vanishing. 
A remeshing strategy was developed in \refpaper{A} to deal with this issue.
The assumption of viscous flow alleviates part of the problem, as there are no state variables to map to the new mesh.
Only the updated surfaces need to be tracked.
However, that alone represents a considerable computational effort since multiple phases and boundary conditions are present.

% \subsection{RVE-problem}
% \begin{figure}[th!]
%   \centering
%   \input{figures/sintering_rve.tikz}
%   \caption{Microstructure of porous particulate material with sintering particles in contact.}
%   \label{fig:micro}
% \end{figure}
% The fundamental microconstituents of the subscale are defined in Figure~\ref{fig:micro}.
% Surface tension could be considered on all boundaries; $\Gamma_i^{\mathrm{pore}}$ and $\Gamma_j^{\mathrm{cont}}$; however, it is assumed to be zero on $\Gamma_j^{\mathrm{cont}}$ in all the numerical examples in the appended papers.
% %
% \begin{figure}[H]
%     \centering
%     \input{figures/4particle_rve.tikz}
%     %\subfloat[$t = 0$]{\input{figures/4particle_rve.tikz}\label{fig:4particle_rve_a}}
%     %\subfloat[$t > 0$]{\input{figures/4particles_deformed.tikz}\label{fig:4particle_rve_b}}
%     \caption{Idealized initial configuration of the RVE in 2D consisting of circular particles in a square lattice.}
%     \label{fig:4particleRVE}
% \end{figure}
% %
% In the simplest form, the RVE is idealized to a unit cell with four contacting circular particles.
% The size of the initial contact surface after compaction is represented by the length $a_0$.
% 
% During the FE-simulation of the RVE, the mesh becomes very distorted, in particular when the sharp contact is rapidly rounded off and when the pores vanish.
% A remeshing strategy was developed in \refpaper{A} to deal with this issue.

%For the homogenization of the RVE, Dirichlet boundary condition was chosen due to its simplicity. Periodic boundary conditions were not considered to to its difficulty in relation to remeshing and Neumann boundary condition remain as a future work.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Formulation of the two-scale problem}

\section{Preliminaries}

As the amount of detail in the fine scale problem becomes excessive, it is advantageous to use homogenization.
Variationally Consistent Homogenization (VCH) will be used to obtain the two-scale problem, as illustrated in \figref{fig:homogenization}.
A general review of VCH can be found in Appendix A of \refpaper{C}.
In the presence of pores, the pertinent volume averaging operators are
\begin{align}
 \homgen{\bullet} \defeq \frac{1}{\volume} \int_{\Omega_\rve^\particle} \bullet \dif V,\quad \Omega_\rve^\particle \defeq \Omega_\rve \cap \Omega^\particle
\\
 \shomgen{\bullet} \defeq \frac{1}{\volume} \int_{\Gamma^\pore_\rve} \bullet \dif S,\quad \Gamma^\pore_\rve \defeq \Omega_\rve \cap \Gamma^\pore
\end{align}
where $\Omega_\rve$ is the ``window'' of the Representative Volume Element (RVE) as illustrated in \figref{fig:homogenization} and \figref{fig:rve_example}.
At the macroscale, the homogenized properties from solving the RVE-problems replace the material model.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
\begin{figure}[htpb!]
\centering
\begin{tikzpicture}
 \node at (0,0) {\includegraphics[scale=0.6]{figures/Homogenization.pdf}};
 \draw[-] (1.35,1.5) -- +(-0.5,0) node[left] {$\Omega_\rve$};
 \node at (2.5,1.5) {RVE};
 \node at (-2.5,-2.2) {Fine-scale};
 \node at (2.5,-2.2) {Macroscale};
 \node at (0,0) {VCH};
 \draw[latex-] (-4.1,0.1) -- ++(-1,0) node[left] {$\Omega^\particle$};
 \draw[latex-] (-4.2,-0.15) to (-5.1,0.1);
 \draw[latex-] (4.4,0) -- ++(1,0) node[right] {$\Gamma^\Neumann$, $\Gamma^\Dirichlet$};
 \node at (2.5,-0.5) {$\Omega$};
\end{tikzpicture}
\caption{Homogenization of a ``green body''. Particles are not to scale.}
\label{fig:homogenization}
\end{figure}

\begin{figure}[htpb!]
\centering
\begin{tikzpicture}
 \node at (0,0) {\includegraphics[scale=0.15]{figures/initial_rve}};
 \node at (-0.75,0.85) {$\Omega_\rve^\particle$};
 \draw[latex-] (-1.33,0.) -- ++(-1,0) node[left] {$\Gamma_\rve$};
 \draw[latex-] (45:0.5) -- +(1.6,0.5) node[right] {$\Gamma_\rve^\pore$};
\end{tikzpicture}
\caption{Example of an idealized RVE consisting of a single unit cell of spherical particles in contact.}
\label{fig:rve_example}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55

At the core of VCH is the hierarchical split of the unknown primary fields.
In the present case we have two fields, $\ta v$ and $p$, which we decompose into macroscopic and fluctuating parts, $\ta v = \ta v^\macro + \ta v^\fluct$ and $p = p^\macro + p^\fluct$, and depending on how these are chosen different macroscale and RVE-problems are obtained.

When using VCH, one also wishes to preserve typical Galerkin properties, such as symmetry of the macroscale tangent operators.
Therefore, it is crucial also to satisfy the Variationally Consistent Macrohomogeneity Condition (VCMC).
In the appended papers, a VCMC is indeed satisfied, and it can be recognized as a generalized Hill-Mandel condition.


\section{VCH for the macroscopically compressible case}

In \refpaper{A}, the following modeling assumptions are introduced for the macroscale fields $\ta v^\macro$ and $p^\macro$ within each RVE:
First order Taylor expansion of the velocity, and no macroscale pressure, i.e.
\begin{align}
 \ta v^\macro &= \bar{\ta v} + [\bar{\ta v}\outerp\diff]\cdot[\ta x - \bar{\ta x}]
\\
 p^\macro &= 0
\end{align}
A constraint on the fluctuation $\ta v^\fluct$ within each RVE is imposed via the condition
\begin{align}
 \frac{1}{\volume} \int_{\Gamma_\rve} \ta v\outerp\ta n \dif S &= \bar{\ta v}\outerp\diff
% \\
%  \homgen{p} &= 0 ??????????????? CHECK!
\end{align}
As a consequence, the macroscale problem is obtained as follows:
Solve for $\bar{\ta v}$ from
\begin{subequations}\label{eq:prototype_macro_A}
\begin{alignat}{2}
 -\bar{\ts\sigma}\{\bar{\ts d}\}\cdot\diff &= \bar{\ta f} &&\text{ in } \Omega
\label{eq:macro_A_a}
\\
 \bar{\ta v} &= \bar{\ta v}_\prescribed &&\text{ on } \Gamma_\Dirichlet
\label{eq:macro_A_c}
\\
 \bar{\ta t} &= \bar{\ta t}_\prescribed &&\text{ on } \Gamma_\Neumann
\label{eq:macro_A_d}
\end{alignat}
\end{subequations}
where $\bar{\ts d} \defeq [\bar{\ta v}\outerp\diff]^\sym$ and $\bar{\ts\sigma}$ is the homogenized response (derived by VCH) from the RVE-problem.
It is noted that only the velocity exists as a primary field at the macroscale.

The RVE-problem with Dirichlet boundary conditions becomes:
For given $\bar{\ts d}$, compute $(\ta v, p)$ from
\begin{subequations}
\begin{alignat}{2}
 -[\hat{\ts\sigma}_\dev(\devop[\ta v]) - p\ts I]\cdot\diff &= \ta f &&\text{ in } \Omega_\rve^\particle
\label{eq:rve_A_a}
\\
 -\ta v\cdot\diff + \hat{e}(p) &= 0 &&\text{ in } \Omega_\rve^\particle
\label{eq:rve_A_b}
\\
 \ta v &= \bar{\ts d} \cdot[\ta x - \bar{\ta x}] &&\text{ on } \Gamma_\rve
\label{eq:rve_A_c}
\\
 \ta t &= \ta t_\surf &&\text{ on } \Gamma_\rve^\pore
\label{eq:rve_A_d}
\end{alignat}
\end{subequations}

Unfortunately, the theory breaks down at the macroscopically incompressible limit, where the entire macroscopic rate-of-deformation tensor, $\bar{\ts d}$, can no longer be directly controlled, as the bulk stiffness tends to infinity.

\section{VCH with seamless transition to the macroscopically incompressible case}

In \refpaper{C}, the model assumptions for the macroscopic fields are as follows:
First order Taylor expansion of the velocity (or displacement), and zeroth order expansion for the pressure
\begin{align}
 \ta v^\macro &= \bar{\ta v} + [\bar{\ta v}\outerp\diff]\cdot[\ta x - \bar{\ta x}]
\\
 p^\macro &= \bar{p}
\end{align}
Constraints on the fluctuations $\ta v^\fluct$ and $p^\fluct$ within each RVE are imposed via the requirements
\begin{align}
 \homgen{\ta v\outerp\diff} &= \bar{\ta v}\outerp\diff
\\
 \homgen{p} &= \bar{p}
\end{align}
This leads to a macroscale problem in the mixed format:
Solve for $(\bar{\ta v}, \bar{p})$ from
\begin{subequations}\label{eq:prototype_macro}
\begin{alignat}{2}
 -[\bar{\ts\sigma}_\dev\{\bar{\ts d}_\dev, \bar{p}\} -\bar{p}\ts I]\cdot\diff &= \bar{\ta f} &&\text{ in } \Omega
\label{eq:macro_a}
\\
 -\bar{\ta v}\cdot\diff + \bar{e}\{\bar{\ts d}_\dev, \bar{p}\} &= 0 &&\text{ in } \Omega
\label{eq:macro_b}
\\
 \bar{\ta v} &= \bar{\ta v}_\prescribed &&\text{ on } \Gamma_\Dirichlet
\label{eq:macro_c}
\\
 \bar{\ta t} &= \bar{\ta t}_\prescribed &&\text{ on } \Gamma_\Neumann
\label{eq:macro_d}
\end{alignat}
\end{subequations}
where $\bar{\ts d}_\dev = \devop[\bar{\ta v}]$ and $(\bar{\ts\sigma}_\dev, \bar{e})$ are the homogenized response variables (derived by VCH) from the RVE-problem.
The intentional similarity of \eqref{eq:prototype_macro} and \eqref{eq1a}--\eqref{eq1d} is emphasized.
This mixed formulation is capable of seamless transition to the incompressible response, which is identified by $\bar{e} = 0$.

However, in the case when pores and surface tension are present, as in \refpaper{D}, it is necessary to choose the prolongation assumption for the pressure in a non-standard fashion
\begin{align}
 \ta v^\macro = \bar{\ta v} + [\bar{\ta v}\outerp\diff]\cdot[\ta x - \bar{\ta x}]
\label{eq:vm_d}
\\
 p^\macro = \frac{\volume}{|\Omega_\rve^\particle|}[\bar{p} + \frac23\shomgen{\gamma_\surf}]
\label{eq:pm_d}
\end{align}
The requirements on the fluctuations within each RVE are now formulated as
\begin{align}
 \frac{1}{\volume}\int_{\Gamma_\rve}\ta v\outerp\ta n\dif S = \bar{\ta v}\outerp\diff
\label{eq:avg_v_d}
\\
 \homgen{p} - \frac23\shomgen{\gamma_\surf} = \bar{p}
\label{eq:avg_p_d}
\end{align}
With these choices, it is possible to maintain the macroscale problem in \cref{eq:prototype_macro}, as shown in detail in \refpaper{D}.


As an example, the RVE-problem with Dirichlet boundary conditions now becomes:
For given $(\bar{\ts d}_\dev, \bar{p})$, compute $(\ta v, p, \bar{e})$ from 
\begin{subequations}\label{eq:rve}
\begin{alignat}{2}
 -[\hat{\ts\sigma}_\dev(\devop[\ta v]) - p\ts I]\cdot\diff &= \ta f &&\text{ in } \Omega_\rve^\particle
\label{eq:rve_a}
\\
 -\ta v\cdot\diff + \hat{e}(p) &= 0 &&\text{ in } \Omega_\rve^\particle
\label{eq:rve_b}
\\
  \homgen{p} &= \frac23\shomgen{\gamma_\surf} + \bar{p}&&
\label{eq:rve_e}
\\
 \ta v - \frac13\bar{e}\,[\ta x - \bar{\ta x}] &= \bar{\ts d}_\dev \cdot[\ta x - \bar{\ta x}] &&\text{ on } \Gamma_\rve
\label{eq:rve_c}
\\
 \ta t &= \ta t_\surf &&\text{ on } \Gamma_\rve^\pore
\label{eq:rve_d}
\end{alignat}
\end{subequations}
Other possibilities are Neumann and weakly periodic boundary conditions for the RVE-problem, which are elaborated in \refpaper{D}.

As an alternative, the procedure in \refpaper{B} represents pure algebraic manipulations to rewrite \cref{eq:prototype_macro_A} in order to enable the transition to the macroscopically incompressible limit.
The used strategy is to replace the step $\bar{\ts d} \to \bar{\ts\sigma}$ by mixed control for the RVE-problem $(\bar{\ts d}_\dev,\bar{p}) \to (\bar{\ts\sigma}_\dev, \bar{e})$. As the result from this manipulation, one obtains exactly the macroscale problem and the RVE-problem described in \cref{eq:prototype_macro} and \cref{eq:rve} respectively.


The mixed macroscopic $(\bar{\ta v},\bar{p})$-formulation in \cref{eq:prototype_macro} will also require stabilization and the Taylor-Hood approximation is the obvious choice.
The RVE-problem also requires unusual boundary conditions, as seen in \cref{eq:rve_c}, and therefore requires a flexible finite element code for implementation.
The FE\textsuperscript{2} algorithm is available in the open source code OOFEM (cf.\ \cite{patzak_oofem_2000}).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Summary of Appended Papers}

\begin{itemize}
 \item \textbf{\refpaper{A}: \citefield{ohman_computational_2012}{title}}.
Liquid phase sintering of particle agglomerates is simulated as the viscous deformation of particle-particle contact, whereby the single driving force is the surface tension on the particle/pore interface.
Particles are modeled as purely viscous fluids (with no elasticity). 
Computational homogenization is adopted for the RVE with Dirichlet boundary conditions.
A surface motion algorithm is developed that requires complete remeshing of the FE-mesh based on a ``maximum deformation'' criterion. 
Since the particles are intrinsically incompressible, the macroscopic compressibility is determined from shrinking porosity in the substructure.

The numerical examples include free sintering of an RVE and a fully coupled FE\textsuperscript{2}-simulation of a specimen with inhomogeneous initial distribution of porosity.

The FE\textsuperscript{2}-format (only valid for macroscopic compressibility) for the Dirichlet boundary condition is summarized in the following flowchart
\begin{center}
%  \tikzsetnextfilename{box1}
  \input{figures/box1.tikz}
% \includegraphics{box1.pdf}
% \caption{Flow-chart of FE\textsuperscript{2}-format valid only for macroscopic compressibility}
% \label{fig:box1}
\end{center}

 \item \textbf{\refpaper{B}: \citefield{ohman_computational_2013}{title}}.
Liquid phase sintering of particle agglomerates is modeled on the mesoscale as the viscous deformation of particle-particle contact, whereby the single driving force is the surface tension on the particle/pore interface.
On the macroscale, a quasistatic equilibrium problem allows for the prediction of the shrinkage of the sintering body. 
The present paper presents a novel FE\textsuperscript{2} formulation of the two-scale sintering problem allowing for the transition to zero porosity, implying macroscale incompressibility.
The seamless transition from compressibility to incompressibility on the macroscale is accomplished by introducing a mixed variational format of the macroscale problem.
This has consequences also for the formulation of the mesoscale problem, that is complemented with an extra constraint equation regarding the prolongation of the volumetric part of the macroscopic rate-of-deformation.

The numerical example shows the sintering of a single Representative Volume Element (RVE), which is sheared beyond the point where the porosity vanishes while subjected to zero macroscopic pressure.

The FE\textsuperscript{2}-format (modified to handle seamless transition from macroscopic compressibility to incompressibility) for the Dirichlet boundary condition is summarized in the following flowchart
\begin{center}
%  \tikzsetnextfilename{box2}
  \input{figures/box2.tikz}
% \includegraphics{box2.pdf}
% \caption{Flow-chart of FE\textsuperscript{2}-format for seamless transition from macroscopic compressibility to incompressibility}
% \label{fig:box1}
\end{center}


 \item \textbf{\refpaper{C}: \citefield{ohman_variationally_2014}{title}}.
In this work, a mixed displacement-pressure formulation for elasticity is considered as the prototype problem.
Variationally Consistent Homogenization (VCH) is directly used to derive the macroscale problem, and the Variationally Consistent Macrohomogeneity Condition (VCMC) is used to determine the RVE-problem.
Dirichlet, Neumann, and (weakly) periodic boundary conditions for the RVE's are derived, and it is shown that the Dirichlet and Neumann boundary conditions provide bounds for the periodic boundary condition in terms of effective stiffness.

The numerical examples show the convergence rate of the Neumann and Dirichlet boundary conditions for a series of 3D Statistical Volume Elements (SVE's).
A final example shows the influence of the compressibility of the microconstituents on the homogenized macroscopic shear modulus.


The FE\textsuperscript{2}-format for the weakly periodic boundary condition is summarized in the following flowchart
\begin{center}
%  \tikzsetnextfilename{box3}
  \input{figures/box3.tikz}
% \includegraphics{box3.pdf}
% \caption{Flow-chart of FE\textsuperscript{2}-format ...}
% \label{fig:box3}
\end{center}


 \item \textbf{\refpaper{D}: \citefield{ohman_new_2014}{title}}.
The final work in this thesis combines the Variationally Consistent Homogenization strategy presented in \refpaper{C} with the mesoscale modeling in \refpaper{A} and \refpaper{B}.
In particular, it is shown that the Dirichlet boundary condition becomes equivalent to that in \refpaper{C}.
Also highlighted in this paper is that the surface tension may obtain an additional contribution to the deviatoric part of the macroscopic stress, whereas traditional models for sintering only accounts for volumetric macroscopic ``sintering stress''.
The deviatoric contribution to the macroscopic stress is naturally captured by the RVE-problems as part of the homogenization procedure.

The numerical examples show the transient behavior of the Neumann and Dirichlet boundary conditions for a 2D RVE subject to free sintering.
The effective macroscale properties of the Dirichlet, Neumann and weakly periodic boundary condition are compared for a 3D microstructure.

The FE\textsuperscript{2}-format for the weakly periodic boundary condition is summarized in the following flowchart
\begin{center}
%  \tikzsetnextfilename{box4}
  \input{figures/box4.tikz}
% \includegraphics{box4.pdf}
% \caption{Flow-chart of FE\textsuperscript{2}-format ...}
% \label{fig:box4}
\end{center}

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Contributions of the thesis}
\begin{itemize}
 \item In \refpaper{A} and the extension in \refpaper{B}, we find the first variationally consistent multiscale problem for sintering.
   In \refpaper{B} the procedure is extended into the macroscopically incompressible regime. Numerical investigations show how the pore shape strongly influences the ``sintering stress''.
 \item To deal with large topological changes in the RVE-problems, a surface tracking algorithm capable of tracking multiple phases, allowing for vanishing pores and the tracking multiple regions for boundary conditions, was implemented for \refpaper{A}. 
   This allow for the Lagrangian mesh to follow the free surface flow of the sintered particles to the point of vanishing porosity, as the FE\textsuperscript{2}-simulations in \refpaper{B} demonstrates.
 \item In \refpaper{C}, VCH is applied to elasticity in mixed $(\ta u,p)$-formulation for the first time.
  Numerical examples investigate the influence of bulk modulus of constituents (to the point of macroscopic incompressibility) on the homogenized shear modulus.
 \item The weakly periodic, Dirichlet, and Neumann boundary conditions for the RVEs under mixed $(\bar{\ts d}_\dev,\bar{p})$-control are derived for the first time.
 \item Finalizing the thesis with \refpaper{D}, we find VCH applied to mixed formulation, allowing for incompressibility and existence of pore space with surface tension.
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Concluding remarks and Future work}

In this thesis a novel approach to simulate the sintering process as a problem of computational homogenization is presented, replacing traditional (macroscopic) constitutive modeling.
With the proposed homogenization procedure, a seamless transition from the macroscopically compressible to the incompressible response is ensured, which is of vital importance when modeling sintering of particle composites.

Through rigorously applying VCH, we can ensure that the obtained macroscale problem is sound, and the RVE-problem retains the same strong form as the fine scale problem.
These properties allow for a straightforward FE-implementation.

For the homogenization procedure, pores on the RVE-boundaries remain complicated.
Weakly periodic and Neumann boundary conditions are not applicable, while Dirichlet boundary conditions constrains the closing of pores on the boundary.
A strongly periodic boundary condition could therefore be a necessity for RVEs with pores intersecting the boundary, but makes it considerably harder to (re)generate a mesh.


There are also possible improvements of the subscale modeling, where the bulk- and surface-diffusion is still missing.
Due to limitations in the remeshing and post-processing software, the microstructural properties of the ``green body'', i.e.\ before the sintering process starts, have so far only been idealized to contacting spheres.
While these serve the need for demonstrating the homogenization procedure, they fail to capture a realistic microstructure of many typical sintered products.

An attempt to address the large topological changes have been outlined in \refpaper{A}, but is lacking a robust 3D implementation.
Alternative methods such as level sets, volume fractions, or particle-FEM could offer a simpler numerical procedure for the fine-scale problem.

\end{document}
