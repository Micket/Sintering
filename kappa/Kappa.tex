% Sample file on how to use subfiles.
\documentclass[MikaelDissertation.tex]{subfiles}

\begin{document}

\chapter{Introduction}

\section{The process of sintering of hardmetal}

Manufacturing of PM products is based on the ``welding'' (sintering) of particles due to heating or combined heating and mechanical loading (uniaxial or isotropic pressing).
To model and simulate the sintering of hard metals, typically WC with Co as the binder metal in the case of a WC-Co-Ti-C system, is particularly challenging in view of the fact that the sintering process involves both solid and melt states of the constituents.
In brief, the manufacturing process can be split into three different sequential stages:
(I) Compaction of powder compound, with initially around \SI{70}{\percent} porosity, into a ``green body'' with roughly \SIrange{20}{40}{\percent} porosity.
(II) Heating in oven up well above the melting temperature for Co (ca \SI{1500}{\celsius}).
(III) Cooling to room temperature.

The purpose is to achieve net-shape already of the green body, whereby the subsequent sintering would result mainly in change of volume (without distortion, i.e. shear deformation).
Since uniaxial pressing is normally used for the initial compaction of hard metal, it is likely that wall friction leads to inhomogeneous
distribution of residual stresses and bulk density in the green body (at least to some extent).
This is an unwanted effect that obscures the goal of net-shape.

During the heating phase, thermal expansion is combined with a certain amount of solid state sintering before melting of the binder, which is necessary in order to achieve ``liquid-phase'' sintering.
During the hold-time at the given temperature, significant compaction (densification, consolidation) takes place due to a combination of solid deformation, diffusion and liquid motion, which brings about reduced porosity.
The so-called ``sintering stress'', which is a macro-scale manifestation of the surface tension between the constituents and the pores, is the ``driving force'' for compaction; hence, sintering can take place under zero external load of the specimen (known as ``free sintering'').
However, the residual stresses after compaction will effect the process.

\textbf{Remark:} It is possible to achieve a sintered product below or above the melting temperature of the Co-binder.
Up to \SI{80}{\percent} of the densification can be achieved in pure solid state sintering, although a completely dense product can only be achieved with liquid phase.
These two cases are often denoted solid and liquid state sintering, respectively, in the literature.

% There are generally two characteristic stages in terms of porosity characteristics:
% At the early stage of sintering all pores are connected, which leads to quite rapid densification, in particular due to viscous flow of the liquid binder. Later on, within a certain temperature interval, all binder has solidified and the (possibly remaining) pores are closed off (and isolated) into near-equilibrium, which leads to much lower rate of consolidation.

Clearly, the aim of the process is that the final product is completely dense, i.e. there is no rest-porosity, with no net-shape distortion.
This may be hard to accomplish if the green body bulk density is severely inhomogeneous and/or the liquid phase sintering is inefficient (in terms of insufficient amount of binder phase and/or incomplete melting).

\section{Modeling and simulation efforts --- A brief review}

A wealth of literature deals with the modeling and simulation of the sintering process.
Primarily, this relates to the constitutive modeling of
(1) the powder material response for green body (pre)compaction and 
(2) the high temperature response and sintering mechanisms pertinent to both solid and liquid phase sintering.
Modeling efforts can be classified by two major paradigms: \emph{a priori macroscale modeling} and \emph{micromechanics modeling and computational homogenization}.

\subsection{Macroscale modeling}
\textbf{update!}

A vast majority of the existing literature on \emph{a priori} macro-scale modeling is devoted to the compaction stage, and it is noted that very few (if any) attempts have been made to develop a unifying macroscopic constitutive model for the compaction and sintering stages.
As to the compaction process, material rate-independence (elasto-plasticity) is a common (and valid) assumption.
Such plasticity models are often taken, at least conceptually, from soil mechanics.
The major focus is on the evolution of the yield surface due to changing porosity as the predominant hardening mechanism, e.g.\ Fleck et al.\ \cite{fleck_yielding_1992},
Oliver et al.\ \cite{oliver_plasticity_1996}, Brandt and Nilsson \cite{brandt_fe-simulation_1998}, Redanz \cite{redanz_numerical_1998}, Kraft \cite{kraft_optimizing_2003}.

For the solid phase sintering, the major feature is the strong rate-dependence close to, and above, the melting temperature of the binder.
Models based on viscoelasticity and viscoplasticity have, therefore, been proposed to simulate the creep behavior of the highly deformable (and even partly melt) binder, e.g. Shinagawa \cite{shinagawa_finite_1996}, Brandt and Nilsson \cite{brandt_fe-simulation_1998}.
Clearly, it is of utmost importance to model the high sensitivity of yield stress to temperature, e.g. Mähler et al.\ \cite{mahler_modelling_2000}.
The task of providing a rational thermodynamic definition of the sintering stress was addressed by, e.g. Reid and Oakberg \cite{reid_continuum_1990}, Mähler and Runesson \cite{mahler_constitutive_2003}.

As to liquid phase sintering, the text-book by German \cite{german_sintering_1996} is still an authority in the field.
Examples of the rich literature are Svoboda et al.\ \cite{svoboda_model_1996}, Xu and Mehrabahdi \cite{xu_micromechanical_1997}, Lu et al.\ \cite{lu_porosity_2001}, who used a single-phase approach.

% To date, it seems that no attempts have been made in the literature to use mixture theory, which explicitly acknowledges the coexistence of a solid skeleton of the WC-particles and partly solidified and liquid Co.

\subsection{Micromechanics modeling and computational homogenization}

Most micromechanically based models consider idealized geometrical arrangement, such as a regular array of (in many cases only two) spheres, within a Representative Volume Element (RVE).
One common approach is to consider grain boundary diffusion, e.g. Helle, et al.\ \cite{helle_hot-isostatic_1985}, McMeeking and Kuhn \cite{mcmeeking_diffusional_1992}, Riedel and Svoboda \cite{riedel_theoretical_1993} and Shinagawa \cite{shinagawa_finite_1996} and particle bridging via diffusion, e.g. Svoboda and Riedel \cite{svoboda_new_1995}, Bient \cite{bient_modeling_2004}, Luque et al.\ \cite{luque_simulation_2005}, as the principal mechanisms for densification.
% TODO: Really?
Some attempts have been made too include more realistic microstructural arrangements and carry out computational homogenization to obtain response functions, e.g. Mähler and Runesson \cite{mahler_modelling_2000}.

Early attempts to numerically simulate the surface-tension driven reshaping of contacting particles are by Jagota and Dawson \cite{jagota_micromechanical_1988,jagota_micromechanical_1988-1} and van de Vorst \cite{van_de_vorst_integral_1993}.
In a series of papers, Zhou and Derby \cite{zhou_three-dimensional_1998,zhou_assessment_2001} emphasize efficient finite element algorithms to trace the complex 3-dimensional flow of multi-particle interaction.
The main challenges  are the complex subscale geometry and the moving free boundary giving rise to very large deformations and severe topology changes.
Recent developments of free-boundary tracing FE-strategies for large deformations (without severe topological changes) are discussed by Peri\'c and coworkers, \cite{dettmer_computational_2006}, \cite{saksono_finite_2006}, \cite{saksono_finite_2006-1}.
All the mentioned work consider surface tension effects in fluids.
A recent extension to include surface tension in the context of solid modeling, where anisotropic surface energy may be present, is due to Javili and Steinmann \cite{javili_finite_2010}.

Micro-mechanical analysis must be accompanied by computational homogenization in order to obtain a predictive model for a component.
One possibility is socalled upscaling, i. e. to use the subscale modeling to calibrate a macroscopic model.
A more appealing, but theoretically and computationally more challenging, possibility is to carry out full-fledged simultaneous coupling between the micro- and macro-scales, which is known as Computational Multiscale Modeling (CMM), or the FE\textsuperscript{2} strategy.
This is certainly the current international trend in material modeling for engineering purposes; however, to our knowledge no work on the fully coupled FE\textsuperscript{2} applied to the sintering problem has been published (at least not in main-stream journals).

\chapter{Aim and Scope of Research}

The thesis concerns the development of a predictive tool for the computational modeling of sintering of hardmetal, that involves a liquid (melt binder) phase.
Virtually all modeling in the literature aiming for quantitative predictions on the engineering scale is based on \emph{a priori} homogenized macroscopic material models.
In this Ph.D.\ project (of which the present licentiate thesis represents the first part), the relevant equations are obtained via micromechanical modeling and computational homogenization.

The main purpose and specific aims of the Ph.D. project are two-fold:
\begin{itemize}
\item To establish a computational model for the prediction of final shape (distortion), residual stresses and remaining porosity in sintered hardmetal products.
Particular emphasis is placed on the role of liquid phase sintering, e.g. with respect to the amount and composition of the (melt) binder metal, size distribution of particles, etc.

\item To calibrate and validate the constitutive models using data from the literature and from present and past collaborators.
Experimental data from component tests are available from a previous joint research project with Swedish partners.
\end{itemize}
In order to achieve this goal, the following tasks are identified in the present licentiate thesis:
\begin{itemize}
 \item Develop the micro-mechanical relations for an ideal setting of viscous particles in contact that sinter due to surface tension.
 \item Use computational homogenization and a fully coupled FE\textsuperscript{2} strategy to obtain a predictive model.
 \item Develop FE-software, in particular for efficient implementation of parallel algorithms.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Theory}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Constitutive modeling of constituents}
Elastic deformation is neglected in the subscale constituents, which is a reasonable assumption since the (visco)plastic deformation is totally dominating the process.
With plastic incompressibility, this leads to an isotropic incompressible Stokes flow within the particles.
The chosen constitutive model is potentially nonlinear and the stress deviator $\ts\sigma_\dev$ is proportional the deviatoric strain rate $\ts d_\dev$:
\begin{equation}
    \ts{\sigma}_\dev(\ts{d}) = 2\tilde{\mu}\ts{d}_\dev, \quad
    \tilde{\mu}\defeq \frac{\sigma_\eqv}{3d_\eqv}
    %\frac{\mu}{1+\frac{3\mu k\left(\sigma_\eqv\left(d_\eqv\right)\right)}{\sigma_\eqv\left(d_\eqv\right)}}
%\label{eq203}
\end{equation}
Thermal expansion is not yet considered, which means that the process is assumed to take place after initial heating.

It is worth noting that, even though the subscale constituents are incompressible, the macroscopic change is compressible due to shrinking pores within the RVE's. The macroscopic response of a given specimen will eventually be partially incompressible at the later stages of sintering. 
In \refpaper{B}, the problem of incompressible RVE's is dealt with.

In the absence of acceleration, the balance equations for the quasi-static motion of the viscoplastic particles can be established in the spatial setting as follows:
%-----------------------------------------------------------------
\begin{subequations}\label{eq:stokesflow}
\begin{align}
    -\ts{\sigma}\cdot\diff & = \ts{0} \quad% \text{ in }\Omega^\particle \defeq \cup_i \Omega^\particle_i
\label{eq:stokesflow_momentum}
\\
    \ta{v}\cdot\diff & = 0 \quad% \text{ in }\Omega^\particle
\label{eq:stokesflow_continuity}
\end{align}
\end{subequations}
Note that these equations are intrinsic to the particles.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Fine-scale problem}

\subsection{Mixed velocity-pressure formulation}
We consider a generic micro-heterogeneous material in a given body whose macroscopic configuration occupies the region $\Omega$ in space with (presumed smooth) boundary $\Gamma$.
However, the actual medium has pores, which means the particle composite only occupies only the region $\Omega^\particle$.
We are then lead to defining a Representative Volume Element (RVE), that represents the topology of the micro-heterogeneous microstructure, as shown in \Cref{Figure1}.
The total domain occupied by the cubic RVE is denoted $\Omega_\rve$ with external boundary $\Gamma_\rve$, while particles within the RVE occupies $\Omega_\rve^\particle$.
%-----------------------------------------------------------------------------------------------------------------------------
% \begin{figure}
% \centering
% %\hspace{0.9cm}
% %\scalebox{1.0}{
% \begin{tikzpicture}
% %\tikzstyle{every node}=[font=\Large]
% \node [inner sep=0pt,above right]{
%    \includegraphics[scale=.3]{SwissCheeseFig}
%    };
% %\draw[<-, line width=.4mm] (1.6,5.0) .. controls +(up:0.5cm) and +(left:0.5cm) .. (2.5,5.7) node[right=1pt,black,text width=3cm,text badly ragged]{$\Gamma_\rve$};
% \draw[<-, line width=.4mm] (5.0,3.5) .. controls +(right:0.5cm) and +(left:0.5cm) .. (6.0,3.5) node[right,black]{$\Gamma_\rve$};
% \draw[<-, line width=.4mm] (4.6,2.) .. controls +(right:0.5cm) and +(left:0.5cm) .. (6.0,2.0) node[right,black]{$\Gamma_\rve^\pore$};
% %\draw[-*, line width=.4mm] (-1.0,1.5) node[left=-2.0cm,black,text width=3cm,text badly ragged]{$\Omega_{\rve,i}^\mathrm{p}$} .. controls +(right:0.5cm) and +(left:1.cm) .. (0.6,1.1);
% \draw[-*, line width=.4mm] (-1.0,2.1) node[left,black]{$\Omega_\rve^\particle$} .. controls +(right:0.5cm) and +(left:1.cm) .. (0.6,2.1);
% \draw[-*, line width=.4mm] (-1.0,3.1) node[left,black]{$\Omega_\rve^\pore$} .. controls +(right:0.5cm) and +(left:1.cm) .. (1.2,3.1);
% %\draw[<-, line width=.4mm] (4.6,1.7) .. controls +(right:0.5cm) and +(left:0.5cm) .. (6.0,1.0) node[right=1pt,black,text width=3cm,text badly ragged]{$\partial\Omega_{\rve,i}^\text{p}$};
% \end{tikzpicture}
% %}
% \caption{Generic micro-heterogeneous material consisting of inclusions in matrix (example)}
% \label{Figure1}
% \end{figure}

We consider a model material as follows: The stress is decomposed in terms of deviator and pressure as $\ts{\sigma} = \ts{\sigma}_\dev - p\ts{I}$.
With the kinematic definition $\devop[\ta v]\defeq[\ta v\outerp\diff]^\sym-\frac{1}{3}[\ta v\cdot\diff]\ts{I}$, we introduce the constitutive relations
%------------------------------------------------------------------------------------------------------------
\begin{equation}
    \ts{\sigma}_\dev = \hat{\ts{\sigma}}_\dev(\devop[\ta v]), \quad
    \ta v\cdot\diff = \hat{e}(p)
\label{eq201}
\end{equation}
%------------------------------------------------------------------------------------------------------
Hence, $\hat{\ts{\sigma}}_\dev(\bullet)$ and $\hat{e}(\bullet)$ denote suitable constitutive functions.
In the simplest case of viscous fluid, we have $\hat{\ts{\sigma}}_\dev(\ts{d}_\dev)=2\mu\ts{d}_\dev$ and $\hat{e}(p)=- C p$, where $\mu(\ta{x}), C(\ta{x})$ for $\ta{x}\in\Omega$ may fluctuate strongly.
Moreover, intrinsic incompressibility is defined as $\hat{e}(p)=0$ for any value of $p$.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
\subsection{Surface tension}

\begin{figure}[th!]
    \centering
    \input{figures/surface_stress_plane.tikz}
    \caption{Thin shell representing a surface with in-plane forces due to ``surface tension''.}
    \label{fig:surfacestress}
\end{figure}
A vital part of the simulation is the modeling of surface tension which acts as the ``driving force'' for liquid-phase sintering.
An extensive theory on boundary energy potentials has been developed by Steinmann \cite{steinmann_boundary_2008}, which has served as the basis for the surface tension modeling in this work.
In short; equilibrium across a surface $\Gamma$ represented by a thin shell bounded by the curve $\mathcal{C}$, as in Figure~\ref{fig:surfacestress} can be stated as:
\begin{align}
    \ta{t}^+ + \ta{t}^- + \ta{t}_\surf &= \ta{0} \quad \text{on} \,\, \Gamma \quad \text{with } \ta{t}_\surf \defeq \hat{\ts\sigma}\cdot\hat{\diff}
\label{eq103KR}\\
    \sum_i \hat{\ta t}_i &= \ta{0} \quad \text{on} \,\, \mathcal{C}
\label{eq104KR}
\end{align}
where $\hat\diff \defeq \diff - [\diff\cdot\ta n]\ta n$.
For an isotropic surface potential one obtains $\hat{\ts\sigma} = \gamma_\surf[\ts I-\ta n\outerp\ts n]$ and the common expression for the surface traction representing surface tension is obtained:
\begin{align}
 \ta t_\surf = -\kappa \gamma_\surf \ta n,\quad \text{where}\quad \kappa \defeq \ts n\cdot\hat\diff
\end{align}
where $\kappa$ is the Gaussian curvature.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
\subsection{Weak format of fine scale problem}
We are now in the position to formulate the strong format of the fine-scale problem under standard quasistatic conditions and small strain kinematics:
%------------------------------------------------------------------------------------------------------------
\begin{subequations}\label{eq1}
\begin{alignat}{2}
    -\left[\hat{\ts{\sigma}}_\dev(\devop[\ta v])-p\ts{I}\right]\cdot\diff & = \ta{f} &&\,\,\text{in}\,\, \Omega^\particle
 \label{eq1a} \\
    -\ta v\cdot\diff +  \hat{e}(p) & = 0 &&\,\,\text{in}\,\, \Omega^\particle
\label{eq1b} \\
    \ta v & = \ta v_\prescribed &&\,\,\text{on}\,\, \Gamma^\Dirichlet
\label{eq1c} \\
    \ta{t}\defeq\left[\hat{\ts{\sigma}}_\dev(\devop[\ta v])-p\ts{I}\right]\cdot\ta{n} & = \ta t_\prescribed &&\,\,\text{on}\,\, \Gamma^\Neumann
\label{eq1d} \\
    \ta{t}\defeq\left[\hat{\ts{\sigma}}_\dev(\devop[\ta v])-p\ts{I}\right]\cdot\ta{n} & =\ta{t}_\surf &&\,\,\text{on}\,\, \Gamma^\pore
\label{eq1surf}
\end{alignat}
\end{subequations}
%-----------------------------------------------------------------------------------------------------
The corresponding weak format is: Find $\ta v\in\set{V}, p\in\set{P}$ s.t.
%----------------------------------------------------------------------------------------------------------------
\begin{subequations}\label{eq2}
\begin{alignat}{3}
    a(\ta v;\delta\ta v) + b(p,\delta\ta v) &= l^\pore(\delta\ta v) + l(\delta\ta v) &\quad& \forall \delta\ta v &&\in \set{V}^{0}
\label{eq2a} \\
    b(\delta p,\ta v) + c^*(p;\delta p) &= 0 &\quad& \forall \delta p &&\in \set{P}
\label{eq2b}
\end{alignat}
\end{subequations}
%----------------------------------------------------------------------------------------------------------------------
where
%----------------------------------------------------------------------------------------------------------------
\begin{align}
    a(\ta{v};\ta{w}) &\defeq
    \int_{\Omega^\particle}  \devop[\ta{w}]\dprod \hat{\ts{\sigma}}_\dev(\devop[\ta{v}]) \dif V
\label{eq3a} \\
    b(q,\ta{v}) &\defeq
    - \int_{\Omega^\particle}  q\,\ta{v}\cdot\diff \dif V
\label{eq3b} \\
    c^*(q;r) &\defeq
    \int_{\Omega^\particle}  r\,\hat{e}(q) \dif V
\label{eq3c} \\
    l^\pore(\ta{v}) &\defeq -\int_{\Gamma^\pore} \gamma_\surf \hat{\ta I} \dprod [\ta{v}\outerp\diff] \dif S 
\label{eq3d} \\
    l(\ta{v}) &\defeq \int_{\Omega^\particle} \ta{v}\cdot\ta{f} \dif V + \int_{\Gamma^\Neumann} \ta{v}\cdot \ta t_\prescribed \dif S
\label{eq3e}
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \subsection{RVE-problem}
% \begin{figure}[th!]
%   \centering
%   \input{figures/sintering_rve.tikz}
%   \caption{Microstructure of porous particulate material with sintering particles in contact.}
%   \label{fig:micro}
% \end{figure}
% The fundamental microconstituents of the subscale are defined in Figure~\ref{fig:micro}.
% Surface tension could be considered on all boundaries; $\Gamma_i^{\mathrm{pore}}$ and $\Gamma_j^{\mathrm{cont}}$; however, it is assumed to be zero on $\Gamma_j^{\mathrm{cont}}$ in all the numerical examples in the appended papers.
% %
% \begin{figure}[H]
%     \centering
%     \input{figures/4particle_rve.tikz}
%     %\subfloat[$t = 0$]{\input{figures/4particle_rve.tikz}\label{fig:4particle_rve_a}}
%     %\subfloat[$t > 0$]{\input{figures/4particles_deformed.tikz}\label{fig:4particle_rve_b}}
%     \caption{Idealized initial configuration of the RVE in 2D consisting of circular particles in a square lattice.}
%     \label{fig:4particleRVE}
% \end{figure}
% %
% In the simplest form, the RVE is idealized to a unit cell with four contacting circular particles.
% The size of the initial contact surface after compaction is represented by the length $a_0$.
% 
% During the FE-simulation of the RVE, the mesh becomes very distorted, in particular when the sharp contact is rapidly rounded off and when the pores vanish.
% A remeshing strategy was developed in \refpaper{A} to deal with this issue.

%For the homogenization of the RVE, Dirichlet boundary condition was chosen due to its simplicity. Periodic boundary conditions were not considered to to its difficulty in relation to remeshing and Neumann boundary condition remain as a future work.

\section{Variationally Consistent Homogenization (VCH)}

Throughout all included papers, the VCH method has been applied.
We introduce the abbreviated notation $z = (\ta v, p) \in \set{Z} = \set V \times \set P$, where $\set Z$ represents the space of fine-scale (non-homogenized) solutions.
Similarly, $\set Z^0 = \set V^0 \times \set P$ is the test space and where each $\ta v\in \set V^0$ vanishes on the Dirichlet part of the boundary.

The abstract formulation of a multifield problem based on a given set of balance (or constraint) equations may conveniently be abbreviated in abstract form as the residual equation
%-------------------------------------------------------------------------------------------------------------------------------
\begin{align}
 R(z; \delta z) \defeq R_\Omega(z; \delta z) + R_\Gamma(z;\delta z) = 0\quad \forall\;\delta z\in \set Z^0
\label{eq:A1}
\end{align}
VCH is applied on all 
No explicit reference to the specific character of the underlying problem is made in this section.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{VMS-approach -- Scale separation and homogenization}

Classical model-based homogenization can be formulated in the spirit of the Variational MultiScale method (VMS), cf.\ \cite{hughes_variational_1998}, \cite{larson_adaptive_2007}.

%-------------------------------------------------------------------------------------------------------------------------------

A multiscale formulation of \cref{eq:A1} is defined by the hierarchical split $\set Z = \set Z^\macro \oplus \set Z^\fluct$, where $\set Z^\macro$ contains smooth macroscale functions and $\set Z^\fluct$ is the hierarchical complement of $\set Z^\macro$ that, typically, represents the fine-scale features.
It is assumed that each $z\in \set Z$ can be split uniquely as $z = z^\macro + z^\fluct$ such that $z^\macro \in \set Z^\macro$ and $z^\fluct \in \set Z^\fluct$.
Therefore, solve $z^\macro \in \set Z^\macro$, $z^\fluct \in \set Z^\fluct$ such that \cref{eq:A1} can be represented by the set of equations
%------------------------------------------------------------------------------------------------------------------------------------------------
\begin{subequations}\label{eq:A2}
\begin{alignat}{3}
\label{eq:A2a} & R(z^\macro + z^\fluct; \delta z^\macro) &&= 0 \quad &&\forall\;\delta z^\macro \in \set Z^{\macro,0}\\
\label{eq:A2b} & R(z^\macro + z^\fluct; \delta z^\fluct) &&= 0       &&\forall\;\delta z^\fluct \in \set Z^{\fluct}
\end{alignat}
\end{subequations}
%-----------------------------------------------------------------------------------------------------------------------------
Without introducing further assumptions (approximations), the dimension of the original problem has not changed, i.e.\ \cref{eq:A2} represent two global problems whose solution requires the same computational effort as does \cref{eq:A1}.
In order to reduce the problem dimension based on homogenization (via the assumption of scale separation), we introduce the following key assumptions:

\begin{itemize}
\item The integrands in the pertinent volume integrals are replaced by a running volume average on RVE's
such that, typically, the residual in \cref{eq:A2a} can be rewritten in terms of the contributions defined on each RVE as
%--------------------------------------------------------------------------------------------------------------------------
\begin{align}
\label{eq:A106} R_\Omega(z;\delta z) = \int_\Omega R_\rve(z;\delta z)(\bar{\ta x})\dif\Omega
\end{align}
%--------------------------------------------------------------------------------------------------------------------------
where $R_\rve$ is the RVE-residual that is localized to the Representative Volume Element (RVE).
In practice (in FE-analysis), quadrature is used such that the evaluation of $R_\rve$ is carried out only in the Gauss points.

Furthermore, for the sake of simplicity we assume smoothness of boundary terms, such that $R_\Gamma(z; \delta z^\macro) \approx R_\Gamma(z^\macro;\delta z^\macro)$, i.e.\ no boundary homogenization is necessary.

\item Local approximations for the fluctuation field $z^\fluct$ are introduced in the spirit of VMS.
This means that $z^\fluct \approx \tilde{z}^\fluct\{z^\macro\}\in\set{Z}_\rve^{\fluct}$ is the \emph{approximate} solution of the fine-scale 
equation \cref{eq:A2b} for given $z^\macro$, i.e.\ \cref{eq:A2b} is replaced by ``closed'' RVE-problems (in the macroscale quadrature points) associated with a particular choice of boundary conditions on $\Omega_\rve$.
%In this paper we obtain such ``closed'' RVE-problems by choosing  weakly periodic boundary conditions.
\end{itemize}
Returning to \cref{eq:A2a}, we now replace this problem by the approximate, homogenized, problem
%---------------------------------------------------------------------------------------------------------------------------------------------
\begin{multline}
\label{eq:A3} R(z^\macro+\tilde{z}^\fluct\{z^\macro\};\delta z^\macro) = \int_\Omega R_\rve(z^\macro+\tilde{z}^\fluct\{z^\macro\};\delta z^\macro)(\bar{\ta x})\dif\Omega
 \\
 + R_\Gamma(z^\macro, \delta z^\macro) = 0 \quad \forall\;\delta z^\macro \in \set Z^{\macro,0}
\end{multline}
%--------------------------------------------------------------------------------------------------------------------------------
which has the same dimension as \cref{eq:A2a}.
We note that \cref{eq:A3} represents a valid homogenization problem for any given choice of $\set{Z}_\rve^{\fluct}$; however, to preserve typical Galerkin properties, such as symmetry of the macroscale tangent operator when such symmetry is inherent in the underlying fine-scale problem, it is crucial to satisfy the VCMC.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Variationally Consistent Macrohomogeneity Condition (VCMC)}

We shall assume that there exists a potential $\Pi(z)$ such that \cref{eq:A3} represents the stationary point of $\Pi(z)$, i.e.\ it is assumed that
%---------------------------------------------------------------------------------------------------------------------------------------
\begin{align}
\label{eq:A4} R(z;\delta z) = \Pi'(z;\delta z) \defeq \frac{\dif}{\dif\epsilon}\Pi(z+\epsilon\delta z)|_{\epsilon = 0} = 0\quad \forall\;\delta z \in \set Z^0
\end{align}
%------------------------------------------------------------------------------------------------------
Next, we introduce the crucial \emph{approximation} (restriction) $z \approx z^\macro + \tilde{z}^\fluct\{z^\macro\}$ before evaluation of the stationarity conditions, whereby we obtain
%---------------------------------------------------------------------------------------------------------------------------------------
\begin{align}
\label{eq:A5} \Pi_{z^\macro}'\{z^\macro;\delta z^\macro\} & \defeq
\frac{\dif}{\dif\epsilon}\Pi(z^\macro+\epsilon \delta z^\macro+\tilde{z}^\fluct\{z^\macro+\epsilon \delta z^\macro\})|_{\epsilon = 0} \nonumber \\
& =
R(z^\macro + \tilde{z}^\fluct\{z^\macro\}; \delta z^\macro + (\tilde{z}^\fluct)'\{z^\macro;\delta z^\macro\}) = 0\quad \forall\;\delta z^\macro\in\set Z^{\macro,0}
\end{align}
%------------------------------------------------------------------------------------------------------------------------------------------
where $(\tilde{z}^\fluct)'\{z^\macro;\delta z^\macro\}$ denotes the sensitivity (or directional derivative) of $\tilde z^\fluct$ for a variation $\delta z^\macro$ of the macroscale solution $z^\macro$.
Hence, the choice of test function in \cref{eq:A5} is restricted as compared to \cref{eq:A4}, and this restriction represents a ``generalized Galerkin property'' in terms of the underlying macroscale functions in $\set Z^\macro$.
Moreover, and most importantly, \cref{eq:A5} is completely equivalent to the homogenized problem \cref{eq:A3} if it is possible, for any given $z^\macro\in\set Z^{\macro}$, to satisfy the constraint
%---------------------------------------------------------------------------------------------------------------------------------------------
\begin{align}
\label{eq:A6a} R(z^\macro + \tilde z^\fluct\{z^\macro\}; (\tilde{z}^\fluct)'\{z^\macro;\dif z^\macro\}) = 0\quad \forall\;\dif z^\macro\in\set Z^{\macro,0}(z^\macro)
\end{align}
%-------------------------------------------------------------------------------------------------------------------------------------------------
or, equivalently,
%---------------------------------------------------------------------------------------------------------------------------------------------
\begin{align}
\label{eq:A6b} R(z^\macro + \tilde z^\fluct\{z^\macro\}; \dif\tilde{z}^\fluct) = 0\quad \forall\;\dif\tilde{z}^\fluct\in\tilde{\set Z}'^{\fluct}(z^\macro)
\end{align}
%-------------------------------------------------------------------------------------------------------------------------------------------------
where the test space $\tilde{\set Z}'^{\fluct}(z^\macro)$, which is the tangent space to the approximation space, is defined as
%----------------------------------------------------------------------------------------------------------------
\begin{align}
    \tilde{\set{Z}}'^{\fluct}(z^\macro)\defeq\{\set{Z}^\fluct\ni \dif z^\fluct = (\tilde{z}^\fluct)'\{z^\macro;\dif z^\macro\},\,
    \dif z^\macro\in \set{Z}^{\macro,0}\}
\label{eq:A6c}
\end{align}
%----------------------------------------------------------------------------------------------------------------------
Hence, any $\dif \tilde{z}^\fluct\in\tilde{\set{Z}}'^{\fluct}(z^\macro)$ is a sensitivity of the fluctuation field $\tilde{z}^\fluct$ for a differential change of the macroscale field $z^\macro$ within the considered RVE.
It is computed from the tangent problem that is associated with the RVE-problem.
We refer to \cref{eq:A6a} or \cref{eq:A6b} as a ``Variationally Consistent (generalized) Macrohomogeneity Condition'' (VCMC).
Obviously, a sufficient condition for these identities to hold true is to require the RVE-residual to vanish on each RVE (in each quadrature point), i.e.\ to ensure that
%--------------------------------------------------------------------------------------------------------------------------------------
\begin{align}
\label{eq:A8} R_\rve(z^\macro + \tilde z^\fluct\{z^\macro\};(\tilde{z}^\fluct)'\{z^\macro;\delta z^\macro\}) = 0\quad \forall\;z^\macro,\delta z^\macro\in\set Z^{\macro}|_{\Omega_\rve}\times\set Z^{\macro,0}|_{\Omega_\rve}
\end{align}
%----------------------------------------------------------------------------------------------------------------------------------------------
An even stronger condition is to require that $R_\rve(z;\delta z^\fluct) = 0$ for \emph{any} $\delta z^\fluct$ in a given set of functions that is defined locally for the considered RVE without requiring any implicit (or explicit) 
coupling to the sensitivity field $(\tilde{z}^\fluct)'\{z^\macro;\delta z^\macro\}$, which obviously defines a restricted choice of test functions.
In such a case, the VCMC can be identified as precisely the classical Hill-Mandel macrohomogeneity condition.

Finally, we remark that the VCMC ensures that the macroscale tangent operator becomes symmetrical, since it holds that
%---------------------------------------------------------------------------------------------------------------------------------------
\begin{align}
\label{eq:A9} R'(z;\delta z_1,\delta z_2) = \Pi''(z;\delta z_1,\delta z_2) \defeq \frac{\dif}{\dif\epsilon}\Pi'(z+\epsilon\delta z_2;\delta z_1)|_{\epsilon=0}\quad \forall\;\delta z_1,\delta z_2 \in \set Z^0
\end{align}
%------------------------------------------------------------------------------------------------------
With the introduced approximation $z^\fluct \approx \tilde{z}^\fluct\{z^\macro\}$, the test functions in \cref{eq:A9} are chosen as
%---------------------------------------------------------------------------------------------------------------------------------------
\begin{align}
\label{eq:A10} \delta z_i \approx \delta z_i^\macro + (\tilde{z}^\fluct)'\{z^\macro;\delta z_i^\macro\} \quad \forall\;\delta z_i^\macro\in\set Z^{\macro,0}, \,\, i=1,2
\end{align}
%------------------------------------------------------------------------------------------------------------------------------------------






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Summary of Appended Papers}

The common theme throughout the series articles is the treatment of macroscopic incompressibility.
In \refpaper{A}, the split ($\ta v = \ta v^\macro + \ta v^\fluct$) was only introduced to the velocity field, while the for the incompressibility condition was solved in each RVE independently (i.e.\ $p^\macro = 0$, $p = p^\fluct$).
By choosing to do so, only the momentum balance equation is obtained at the macroscopic level.
In the RVE problem the constraints are placed for a unique decomposition, e.g.\ $\homgen{\ta v \outerp\diff} = \bar{\ta v}\outerp\diff$ (or equivalently $\homgen{\ta v^\fluct\outerp\diff} = \ts 0$) for a first order expansion of the velocity field.
However, at the incompressible limit, when all microconstituents are intrinsically incompressible and no pore space exist, it is necessary to satisfy part of this constraint weakly.
In \refpaper{B} this is done by algebraic manipulation of the FE\textsuperscript{2} procedure derived in \refpaper{A}, while in \refpaper{C} and \refpaper{D} this is obtained directly as part of the homogenization procedure.


For an RVE with no pores or surface tension, as in \refpaper{C}, the prolongation of the macroscopic fields $\bar{\ta v}$ (or equivalently $\bar{\ta u}$) and $\bar{p}$ are as expected;
First order Taylor expansion of the velocity field, and zeroth order expansion for the pressure field
\begin{align}
 \ta v^\macro &= \bar{\ta v} + [\bar{\ta v}\outerp\diff]\cdot[\ta x - \bar{\ta x}]
\\
 p^\macro &= \bar{p}
\end{align}
where we require that in each RVE
\begin{align}
 \homgen{\ta v\outerp\diff} &= \bar{\ta v}\outerp\diff
\\
 \homgen{p} &= \bar{p}
\end{align}

However, in the case when pores and surface tension are present, as in \refpaper{D}, it is necessary to carefully choose the prolongation in such a way that we obtain the desired (simple) macroscale formulation:
\begin{align}
 \ta v^\macro = \bar{\ta v} + [\bar{\ta v}\outerp\diff]\cdot[\ta x - \bar{\ta x}]
\\
 p^\macro = \frac{\volume}{|\Omega_\rve^\particle|}[\bar{p} + \frac23\shomgen{\gamma_\surf}]
\end{align}
where we now require that in each RVE
\begin{align}
 \int_{\Gamma_\rve}\ta v\outerp\ta n\dif S = \bar{\ta v}\outerp\diff
\\
 \homgen{p} - \frac23\homgen{\gamma_\surf} = \bar{p}
\end{align}
However, by rewriting the problem and always connect the scales through the RVE-boundary, we obtain a simple relation that holds true both \refpaper{C} and \refpaper{D};
\begin{align}
 \frac{1}{\volume}\int_{\Gamma_\rve}\ta v\outerp\ta n\dif S &= \bar{\ta v}\outerp\diff
\\
 \frac{1}{\volume}\int_{\Gamma_\rve}\ta t\outerp[\ta x-\bar{\ta x}]\dif S &= \bar{\ts\sigma} \implies \int_{\Gamma_\rve}\ta t\cdot[\ta x-\bar{\ta x}]\dif S = \bar{p}
\end{align}




Following is a short summary of each of the appended papers:
\begin{itemize}
 \item \textbf{\refpaper{A}: \citefield{ohman_computational_2012}{title}}.
Liquid phase sintering of particle agglomerates is simulated as the viscous deformation of particle-particle contact, whereby the single driving force is the surface tension on the particle/pore interface.
Particles are modeled as purely viscous fluids (with no elasticity). 
Computational homogenization is adopted for the RVE with Dirichlet boundary conditions.
A surface motion algorithm was developed that requires complete remeshing of the FE-mesh based on a ``maximum deformation'' criterion. 
Since the particles are intrinsically incompressible, the macroscopic compressibility is determined from shrinking porosity in the substructure.

The numerical examples include free sintering of an RVE and a fully coupled FE\textsuperscript{2}-simulation of a specimen with inhomogeneous initial distribution of porosity.

 \item \textbf{\refpaper{B}: \citefield{ohman_computational_2013}{title}}.
Liquid phase sintering of particle agglomerates is modeled on the mesoscale as the viscous deformation of particle-particle contact, whereby the single driving force is the surface tension on the particle/pore interface.
On the macroscale, a quasistatic equilibrium problem allows for the prediction of the shrinkage of the sintering body. 
The present paper presents a novel FE\textsuperscript{2} formulation of the two-scale sintering problem allowing for the transition to zero porosity, implying macroscale incompressibility.
The seamless transition from compressibility to incompressibility on the macroscale is accomplished by introducing a mixed variational format.
This has consequences also for the formulation of the mesoscale problem, that is complemented with an extra constraint equation regarding the prolongation of the volumetric part of the macroscopic rate-of-deformation.

The numerical example shows the sintering of a single representative volume element (RVE), which is sheared beyond the point where the porosity vanishes while subjected to zero macroscopic pressure.

 \item \textbf{\refpaper{C}: \citefield{ohman_variationally_2014}{title}}.
In this work, a mixed displacement-pressure formulation for elasticity is considered as the prototype problem.
Variationally Consistent Homogenization is directly used to derive the macroscale problem, and the Variationally Consistent Macrohomogeneity condition is used to determine the RVE problem.
Dirichlet, Neumann, and (weakly) periodic boundary conditions for the RVE's are derived, and the Dirichlet and Neumann boundary conditions are shown to be bounds for the periodic boundary condition.

The numerical examples show the convergence rate of the Neumann and Dirichlet boundary conditions for a series of 3D Statistical Volume Elements (SVE's).
A final example shows the influence of the compressibility of the microconstituents on the homogenized macroscopic shear modulus.

 \item \textbf{\refpaper{D}: \citefield{ohman_new_2014}{title}}.
The final work in this thesis extends the Variationally Consistent Homogenization of the mixed formulation presented in \refpaper{C} with the mesoscale modeling found in \refpaper{A} and \refpaper{B}.
In particular, it is shown that the Dirichlet boundary condition becomes equivalent to that in \refpaper{C}.
Also highlighted in this paper is that the surface tension may also have contribution to the deviatoric part of the macroscopic stress, whereas traditional models for sintering only accounts for volumetric macroscopic ``sintering stress''.
The deviatoric contribution to the macroscopic stress is naturally captured by the RVE-problems as part of the homogenization procedure.

The numerical examples show transient behavior of the Neumann and Dirichlet boundary conditions for a 2D RVE subject to free sintering.
A 3D microstructure with porespace and surface tension compares the effective macroscale properties between the Dirichlet, Neumann and weakly periodic boundary condition.
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Contributions of the thesis}
\begin{itemize}
 \item VCH homogenization of mixed v-p to v suitable for the sintering problem.
 \item Extending paper A to allow the particly incompressible FE\textsuperscript{2} simulation (paper B).
 \item VCH of (in)compressible elasticity in mixed u-p formulation.
  (investigating the influence of homogenized shear modulus w.r.t.\ bulk modulus) (paper C)
 \item VCH taking into account pores and surface tension. (paper A, B, D),
  (taking into account for the possibility of anisotropic sintering stress), ()
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Concluding remarks and Future work}

In this thesis a novel approach to simulate the sintering process as a problem of computational homogenization is presented, replacing the traditional macroscopic constitutive models.
With the new proposed homogenization procedure, we can ensure a seamless transition from the macroscopically compressible to the incompressible response, which is of vital importance when modeling sintering of particle composites.

Through rigorously applying VCH, we can ensure that the obtained multiscale problem is sound, and by further manipulation we can obtain a simpler and still consistent RVE-problem that retains the same strong form as the fine scale problem.
These manipulations allows for a straight forward FE-implementation.
The FE\textsuperscript{2} algorithm is freely available in the open source code OOFEM (cf.\ \cite{patzak_oofem_2000}) as free software.

For the homogenization procedure, pores on the RVE-boundaries remain complicated.
Weakly periodic and Neumann boundary conditions are not applicable, while Dirichlet boundary conditions constrains the closing of pores on the boundary.
A strongly periodic boundary condition could therefore be a necessity for these RVEs with pores, but makes it considerably harder to (re)generate a mesh.


There are also possible improvements of the subscale modeling, where the bulk- and surface-diffusion is still missing.
Due to limitations in the remeshing and post-processing software, the microstructural properties of the ``green body'', i.e.\ before the sintering process starts, have so far only been idealized to contacting spheres.
While these serve the need for demonstrating the homogenization procedure, they fail to capture a realistic microstructure, particularly that of WC-Co.

An attempt to address the large topological changes have been outlined in \refpaper{A}, but is lacking a robust 3D implementation.
Alternative methods such as level sets, volume fractions, or particle-FEM could offer a simpler numerical procedure for the fine-scale problem.

\end{document}
