% Written by Mikael Ã–hman <mikael.ohman@chalmers.se>
% Released under public domain. 
% Use with beamer for LaTeX:
%  \usetheme{chalmers}

%  \usepackage{beamerthemesplit}
\mode<presentation>

\def\beamer@fancy@titlepagelogo{}
\DeclareOptionBeamer{titlepagelogo}{\def\beamer@fancy@titlepagelogo{#1}}

\ProcessOptionsBeamer

\newlength{\headerheight}
\newlength{\footerheight}
\newlength{\titlepageheight}
\setlength{\headerheight}{0.04\paperheight}
\setlength{\footerheight}{0.04\paperheight}
\setlength{\titlepageheight}{0.4\paperheight}



% Chalmers recommended fonts for presentations; Times New Roman for titles, Arial/Verdana for rest.
% But, it looks very bad.
%\setbeamerfont{frametitle}{family=\rmfamily}
% Chalmers default colors (+ black and white)
\definecolor{chalmersblue}{rgb}{0,0.2,0.53}
\definecolor{chalmersgrey}{rgb}{0.8,0.8,0.8}
% Not sure what to do with the colortheme.. pretty much ignoring it.
\setbeamercolor{palette primary}{fg=white,bg=chalmersblue}
\setbeamercolor{palette secondary}{fg=white,bg=black}
% %\setbeamercolor*{normal text}{fg=black,bg=white}
% %\setbeamercolor*{example text}{fg=chalmersblue} % Where is this?
\setbeamercolor*{structure}{fg=white, bg=chalmersblue}
\setbeamercolor*{head}{parent=palette secondary}
\setbeamercolor*{foot}{parent=palette primary}
\setbeamercolor*{title page header}{fg=white}

% Items in a cool grey;
\setbeamercolor{itemize item}{fg=chalmersgrey}

% Worth considering;
%\beamertemplateshadingbackground{chalmersgrey}{white}

% Turning off navigation symbols
\usenavigationsymbolstemplate{}

\setbeamertemplate{items}[circle]

%\setbeamersize{text margin left=1em,text margin right=1em}

% Spacing is up to the writer to decide. These are set a bit tighter than default.
% \setlength{\intextsep}{5pt}
% \setlength{\abovecaptionskip}{3pt}
% \setlength{\belowcaptionskip}{0pt}
% \setlength{\abovedisplayskip}{3pt}
% \setlength{\belowdisplayskip}{3pt}
% \setlength{\itemsep}{0pt}

\defbeamertemplate*{title page}{chalmers}[1][]
{
 \begin{tikzpicture}[remember picture, overlay]
  \coordinate (A) at (current page.north west);
  \shade[bottom color=chalmersblue!70,top color=chalmersblue!100] (A) rectangle +(\paperwidth,-\titlepageheight);
  \draw (A) ++(0\paperwidth, -\titlepageheight-0.05\paperheight) node[above right] {\resizebox{!}{\titlepageheight}{\input{ranka2.pgf}}};
  \fill[black] (A) rectangle +(\paperwidth,-\headerheight);
  \draw (A) ++(0,-0.5\headerheight) node[right] {\chalmerslogo{white}{0.5\headerheight}};
  \draw (A) ++(0.6\paperwidth, -0.7\titlepageheight) node {
    \begin{beamercolorbox}[wd=0.6\paperwidth,center,#1]{title page header}
    \usebeamerfont{title}\inserttitle\par%
    \ifx\insertsubtitle\@empty%
    \else%
      \vskip0.25em%
      {\usebeamerfont{subtitle}\insertsubtitle\par}%
    \fi%
    \vspace{.125\paperheight}%
    \end{beamercolorbox}
  };

  \end{tikzpicture}
  \vskip 0.4\paperheight

  \begin{columns}
    \ifx\beamer@fancy@titlepagelogo\@empty%
      \column{\textwidth}
    \else
      \column{.5\textwidth}
      % Logo.
      \begin{centering}
        \vbox{}\vfill
        \includegraphics[height=.4\paperheight]{\beamer@fancy@titlepagelogo}
        %\includegraphics[height=.4\paperheight]{Avancez_black.pdf}
        \vfill
      \end{centering}
      \column{.5\textwidth}
    \fi
    % Authors, institute and date
    \vskip1em\par
    \begin{beamercolorbox}[sep=8pt,center,#1]{author}
    \usebeamerfont{author}\insertauthor
    \end{beamercolorbox}
    \begin{beamercolorbox}[sep=8pt,center,#1]{institute}
    \usebeamerfont{institute}\insertinstitute
    \end{beamercolorbox}
    \begin{beamercolorbox}[sep=8pt,center,#1]{date}
    \usebeamerfont{date}\insertdate
    \end{beamercolorbox}\vskip0.5em
    %{\usebeamercolor[fg]{titlegraphic}\inserttitlegraphic\par}
  \end{columns}
}

\defbeamertemplate*{footline}{chalmers theme}{
 \begin{tikzpicture}
  \fill[chalmersgrey] (0,0) rectangle (\paperwidth,\footerheight);
  % Section hierarchy
  \node[right] at (0,0.5\footerheight) {\usebeamerfont{foot}\insertsectionhead\ ---\ \insertsubsubsectionhead};
  % Authors
  \node[right] at (0.5\paperwidth,0.5\footerheight) {\usebeamerfont{foot}\insertshortauthor};
  % frame/total frames
  \node[left] at (\paperwidth,0.5\footerheight) {\usebeamerfont{foot}\insertframenumber/\inserttotalframenumber};
 \end{tikzpicture}
}

\defbeamertemplate*{headline}{chalmers theme}{%
 \begin{tikzpicture}
  \fill[black] (0,0) rectangle (\paperwidth,\headerheight);
  % CHALMERS logo
  \node[right] at (0.3em,0.5\headerheight) {\chalmerslogo{white}{0.5\headerheight}};
 \end{tikzpicture}
}

% \defbeamertemplate*{frametitle}{chalmers theme}{
%   \nointerlineskip%
%   \hbox{\leavevmode%
%   %\hskip-\Gm@lmargin%
%   \begin{tikzpicture}
%     \fill[chalmersblue] (0,0) rectangle (\paperwidth,\frametitleheight);
%     \node[right] at (0,0.5\frametitleheight) {f\insertframetitle};
%   \end{tikzpicture}}%
%   \hskip-\Gm@rmargin%
% }

% \setbeamertemplate{frametitle}
% {
% 	\hspace*{-0.035\paperwidth} \vbox{\insertframetitle}\par
% 	\hspace*{-0.045\paperwidth}\pgfuseshading{frametitlebarhshad}
% }

\AtBeginDocument{\pgfdeclareverticalshading{beamer@topshade}{\paperwidth}{color(0pt)=(bg);color(4pt)=(black!50!bg)}}

\pgfdeclarehorizontalshading[frametitle.bg,frametitle right.bg]{beamer@frametitleshade}{\paperheight}{color(0pt)=(frametitle.bg);color(\paperwidth)=(frametitle right.bg)}

% \defbeamertemplate*{frametitle}{shadow theme}
% {%
%   \nointerlineskip%
%   \hbox{\leavevmode
%     \hskip-\Gm@lmargin\hbox{%
%       \setbox\beamer@tempbox=\hbox{\begin{minipage}[b]{\paperwidth}%
%           \vbox{}\vskip-.75ex%
%           \leftskip0.3cm%
%           \rightskip0.3cm plus1fil\leavevmode
%           \insertframetitle%
%           \ifx\insertframesubtitle\@empty%
%             \strut\par%
%           \else
%             \par{\usebeamerfont*{framesubtitle}{\usebeamercolor[fg]{framesubtitle}\insertframesubtitle}\strut\par}%
%           \fi%
%           \nointerlineskip
%           \vbox{}%
%           \end{minipage}}%
%       \beamer@tempdim=\ht\beamer@tempbox%
%       \advance\beamer@tempdim by 2pt%
%       \begin{tikzpicture}
%        \fill[chalmersblue] (0,0) rectangle (\paperwidth,\beamer@tempdim);
%       \end{tikzpicture}
%       \begin{pgfpicture}{0pt}{0pt}{\paperwidth}{0.78cm}
%         \usebeamercolor{frametitle right}
%         \pgfpathrectangle{\pgfpointorigin}{\pgfpoint{\paperwidth}{\beamer@tempdim}}
%         \pgfusepath{clip}
%         \pgftext[left,base]{\pgfuseshading{beamer@frametitleshade}}
%       \end{pgfpicture}
%       \hskip-\paperwidth%
%       \box\beamer@tempbox%
%     }%
%     \hskip-\Gm@rmargin%
%   }%
% }

\defbeamertemplate*{frametitle}{shadow theme}
{%
  \nointerlineskip%
  \hbox{\leavevmode
    %\advance\beamer@leftmargin by -12bp%
    %\advance\beamer@rightmargin by -12bp%
    %\beamer@tempdim=\textwidth%
    %\advance\beamer@tempdim by \beamer@leftmargin%
    %\advance\beamer@tempdim by \beamer@rightmargin%
    \hskip-\Gm@lmargin%
    \hbox{%
      \setbox\beamer@tempbox=\hbox{\begin{minipage}[b]{\paperwidth}%
          \vbox{}\vskip-.75ex%
          \leftskip0.3cm%
          \rightskip0.3cm plus1fil\leavevmode
          \insertframetitle%
          \ifx\insertframesubtitle\@empty%
            \strut\par%
          \else
            \par{\usebeamerfont*{framesubtitle}{\usebeamercolor[fg]{framesubtitle}\insertframesubtitle}\strut\par}%
          \fi%
          \nointerlineskip
          \vbox{}%
        \end{minipage}}% Stores a temporary box
      \beamer@tempdim=\ht\beamer@tempbox% % Height of box
      \advance\beamer@tempdim by 2pt%
      \begin{tikzpicture}
       \fill[chalmersblue] (0,0) rectangle (\paperwidth,\beamer@tempdim);
       %\node[right] at (0,0.5\beamer@tempdim) { \insertframetitle\  };
      \end{tikzpicture}
      \hskip-\paperwidth%
      \box\beamer@tempbox% 
    }%
    \hskip-\Gm@rmargin%
  }%
}


%  \defbeamertemplate*{frametitle}{decolines theme}[1][left]
%  {
%  \ifbeamercolorempty[bg]{frametitle}{}{\nointerlineskip}%
%  \@tempdima=\textwidth%
%  \advance\@tempdima by\beamer@leftmargin%
%  \advance\@tempdima by\beamer@rightmargin%
%  \vbox{}\vskip-.5\beamer@leftmargin%
%  \begin{beamercolorbox}[sep=\beamer@leftmargin,#1,wd=\the\@tempdima]{}
%  \usebeamerfont{frametitle}\usebeamercolor[bg]{framesubtitle}%
%  \vbox{}\vskip0ex%
%  \if@tempswa\else\csname beamer@fte#1\endcsname\fi%
%  \strut\insertframetitle\strut\par%
%  {%
%  \ifx\insertframesubtitle\@empty%
%  \else%
%  {\usebeamerfont{framesubtitle}\usebeamercolor[bg]{framesubtitle}\insertframesubtitle\strut\par}%
%  \fi
%  }%
%  \vskip-1ex%
%  \if@tempswa\else\vskip-\beamer@leftmargin\fi
%  \end{beamercolorbox}%
%  \def\beamer@decolines@truetext{true}%
%  \ifx\beamer@decolines@titleline\beamer@decolines@truetext%
%  \vskip-.5\beamer@leftmargin%
%  \begin{beamercolorbox}[wd=\textwidth,ht=.1ex,dp=0ex]{linemid}%
%  \end{beamercolorbox}%
%  \fi
%  }

% Footer using beamercolorboxes
% \defbeamertemplate*{footline}{chalmers theme}{
%  \hbox{%
%  \begin{beamercolorbox}[wd=0.5\paperwidth,ht=2.25ex,dp=1ex,left]{foot}
%   \usebeamerfont{foot}\hspace*{2ex}\insertsectionhead\ -\ \insertsubsectionhead%\ -\ \insertsubsubsectionhead% This one you may want to comment
%  \end{beamercolorbox}%
%  \begin{beamercolorbox}[wd=0.25\paperwidth,ht=2.25ex,dp=1ex,left]{foot}
%   \usebeamerfont{foot}\hspace*{2ex}\insertshortauthor%
%  \end{beamercolorbox}%
%  \begin{beamercolorbox}[wd=0.25\paperwidth,ht=2.25ex,dp=1ex,right]{foot}
%   \usebeamerfont{foot}%
%   %\insertshortdate%
%   \hspace*{2ex}\insertframenumber/\inserttotalframenumber\hspace*{2ex}%
%  \end{beamercolorbox}}
% }
% Header using beamercolorboxes
% \defbeamertemplate*{headline}{chalmers theme}{
%  \hbox{%
%   \begin{beamercolorbox}[wd=\paperwidth,ht=2.5ex,dp=1.5ex,left]{head}%
%    \vspace{-.5ex}\hspace{2ex}%
%    \chalmerslogo{white}{2ex}%
%   \end{beamercolorbox}%
%  }
% }

% CHALMERS logo below. Note! It is trademarked!
%\newcommand{\chalmerslogo}{\input{CHALMERS.tikz}} % Seperate file? More convenient here.
\newcommand{\chalmerslogo}[2]{
\resizebox{!}{#2}{
\begin{tikzpicture}[fill=#1]% This is 11.994 in width, 1.341 in height
% C
\fill (1.481,0.488)
 .. controls (1.385,0.138) and (1.046,0.027) .. (0.742,0.027)
 .. controls (0.304,0.027) and (0,0.256) .. (0,0.687)
 .. controls (0,1.152) and (0.37,1.34) .. (0.76,1.34)
 .. controls (0.901,1.34) and (1.273,1.307) .. (1.437,1.011)
 -- (1.128,0.914)
 .. controls (1.095,0.966) and (0.997,1.102) .. (0.758,1.102)
 .. controls (0.478,1.102) and (0.321,0.919) .. (0.321,0.683)
 .. controls (0.321,0.414) and (0.535,0.271) .. (0.769,0.271)
 .. controls (1.036,0.271) and (1.116,0.411) .. (1.156,0.486)
 -- cycle;

% H
\fill (1.616,1.302) -- (1.925,1.302) -- (1.925,0.827) -- (2.656,0.827) -- (2.656,1.302) -- (2.965,1.302)
 -- (2.965,0.069) -- (2.656,0.069) -- (2.656,0.598) -- (1.925,0.598) -- (1.925,0.069) -- (1.616,0.069)
 -- cycle;

%A
\fill (3.707,1.302) -- (4.041,1.302) -- (4.637,0.069) -- (4.291,0.069) -- (4.168,0.338) -- (3.568,0.338)
 -- (3.449,0.069) -- (3.112,0.069) -- (3.707,1.302) -- cycle
 (3.903,0.923)
 .. controls (3.889,0.955) and (3.876,0.985) .. (3.871,1.021)
 .. controls (3.866,0.986) and (3.851,0.954) .. (3.837,0.922)
 -- (3.668,0.556) -- (4.066,0.556) -- cycle;

% L
\fill (4.796,1.302) -- (5.105,1.302) -- (5.105,0.296) -- (5.728,0.296) -- (5.728,0.069) -- (4.796,0.069) -- cycle;

% M
\fill (5.914,1.302) -- (6.359,1.302) -- (6.687,0.532)
 .. controls (6.721,0.451) and (6.73,0.418) .. (6.743,0.364)
 .. controls (6.756,0.418) and (6.767,0.451) .. (6.8,0.532)
 -- (7.122,1.302) -- (7.564,1.302) -- (7.564,0.069) -- (7.272,0.069) -- (7.272,0.937)
 .. controls (7.272,0.984) and (7.279,1.01) .. (7.285,1.047)
 .. controls (7.272,1.01) and (7.263,0.984) .. (7.243,0.937)
 -- (6.881,0.069) -- (6.6,0.069) -- (6.231,0.937)
 .. controls (6.211,0.984) and (6.205,1.01) .. (6.195,1.047)
 .. controls (6.198,1.01) and (6.205,0.984) .. (6.205,0.937)
 -- (6.205,0.069) -- (5.914,0.069) -- cycle;

% E
\fill (7.85,1.302) -- (8.999,1.302) -- (8.999,1.080) -- (8.159,1.080) -- (8.159,0.802) -- (8.899,0.802)
 -- (8.899,0.584) -- (8.159,0.584) -- (8.159,0.289) -- (9.034,0.289) -- (9.034,0.069) -- (7.850,0.069) -- cycle;

% R
\fill (9.266,1.301) -- (10.128,1.301)
 .. controls (10.219,1.301) and (10.566,1.290) .. (10.566,0.933)
 .. controls (10.566,0.720) and (10.439,0.612) .. (10.246,0.583)
 -- (10.620,0.068) -- (10.265,0.068) -- ( 9.927,0.564) -- ( 9.575,0.564) -- ( 9.575,0.068)
 -- ( 9.266,0.068) -- ( 9.266,1.301) -- cycle
 (9.576,0.782) -- (10.068,0.782)
 .. controls (10.134,0.782) and (10.253,0.791) .. (10.253,0.929)
 .. controls (10.253,1.064) and (10.164,1.085) .. (10.054,1.085)
 -- (9.576,1.085) -- cycle;

% S
\fill (10.956,0.445)
 .. controls (11.028,0.297) and (11.205,0.255) .. (11.373,0.258)
 .. controls (11.448,0.259) and (11.684,0.276) .. (11.681,0.426)
 .. controls (11.680,0.515) and (11.593,0.534) .. (11.527,0.545)
 .. controls (11.476,0.554) and (11.222,0.589) .. (11.164,0.599)
 .. controls (11.051,0.617) and (10.758,0.667) .. (10.758,0.946)
 .. controls (10.758,1.249) and (11.080,1.340) .. (11.326,1.340)
 .. controls (11.612,1.340) and (11.831,1.285) .. (11.981,1.056)
 -- (11.689,0.978)
 .. controls (11.620,1.103) and (11.462,1.121) .. (11.330,1.120)
 .. controls (11.194,1.120) and (11.055,1.089) .. (11.057,0.972)
 .. controls (11.058,0.892) and (11.130,0.872) .. (11.223,0.853)
 .. controls (11.274,0.843) and (11.526,0.805) .. (11.584,0.795)
 .. controls (11.727,0.770) and (11.971,0.723) .. (11.976,0.452)
 .. controls (11.983,0.056) and (11.539,0.033) .. (11.358,0.031)
 .. controls (11.156,0.028) and (10.840,0.057) .. (10.676,0.366)
 -- cycle;
\end{tikzpicture}
}
}
